<html>
  <head>

    <script>

      window.onload = bindEvents;



      function bindEvents(){
        document.getElementById("get").addEventListener("click", emailShow);
        document.getElementById("put").addEventListener("click", emailChange);
        document.getElementById("post").addEventListener("click", emailInsert);
        document.getElementById("delete").addEventListener("click", emailDelete);
      }

      function emailShow(){
      var email = document.getElementById("email").value; // Ottieni l'email dall'input
      var oReq = new XMLHttpRequest();

      oReq.onload = function(){
          console.log("Response:", oReq.responseText);
          document.getElementById("ajaxres").innerHTML = oReq.responseText;
          };

      oReq.open("GET", "api.php/utenti/" + email, true); // Includi l'email nel percorso della richiesta GET
      oReq.send();
      }

      function emailChange(){
        var data = {};
        data.password = document.getElementById("password").value;
        data.email = document.getElementById("email").value;
        var jsondata = JSON.stringify(data);

        var oReq = new XMLHttpRequest();
        oReq.onload = function(){document.getElementById("ajaxres").innerHTML = oReq.responseText;};
        oReq.open("put", "api.php/utenti/" + document.getElementById("oldemail").value, true);
        oReq.send(jsondata);
      }

      function emailInsert(){
        var data = {};
        data.password = document.getElementById("password").value;
        data.email = document.getElementById("email").value;
        var jsondata = JSON.stringify(data);

        var oReq = new XMLHttpRequest();
        oReq.onload = function(){document.getElementById("ajaxres").innerHTML = oReq.responseText;};
        oReq.open("post", "api.php/utenti/", true);
        oReq.send(jsondata);
      }

      function emailDelete(){
        var oReq = new XMLHttpRequest();
        oReq.onload = function(){document.getElementById("ajaxres").innerHTML = oReq.responseText;};
        oReq.open("delete", "api.php/utenti/" + document.getElementById("oldemail").value, true);
        oReq.send();
      }

      /*
      function bindEvents(){
        $("#email").change(emailChange);
      }

      function emailChange(){
        $.ajax({
          url: "service.php?email=" + $("#email").val(),
          success: function(data){$("#password").html(data);}
        });
      }*/

    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  </head>

  <body>

    Inserisci la tua email:
    <input id="oldemail" type="text" placeholder="old email">
    <input id="email" type="text" placeholder="email">
    <input id="password" type="text" placeholder="password">

    <br>

    <button id="get">GET</button>
    <button id="put">PUT</button>
    <button id="post">POST</button>
    <button id="delete">DELETE</button>

    <br>
    AJAX RESPONSE
    <p id="ajaxres"></p>

  </body>

</html>
